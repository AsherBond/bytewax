<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>bytewax.operators &#8212; Bytewax API Docs  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=c631c1db" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="bytewax.operators.helpers" href="bytewax.operators.helpers.html" />
    <link rel="prev" title="bytewax.inputs" href="bytewax.inputs.html" />

  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />





  </head><body>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">


          <div class="body" role="main">

  <section id="module-bytewax.operators">
<span id="bytewax-operators"></span><h1><a class="reference internal" href="#module-bytewax.operators" title="bytewax.operators"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.operators</span></code></a><a class="headerlink" href="#module-bytewax.operators" title="Link to this heading">¶</a></h1>
<p>Built-in operators.</p>
<p>See <a class="reference external" href="https://bytewax.io/docs/getting-started/simple-example">our getting started
documentation</a>
for the basics of building and running dataflows.</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="bytewax.operators.helpers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.operators.helpers</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="bytewax.operators.window.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.operators.window</span></code></a></li>
</ul>
</div>
</section>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Link to this heading">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="bytewax.operators.X">
<span class="sig-name descname"><span class="pre">X</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.12)"><span class="pre">TypeVar</span></a></em><a class="headerlink" href="#bytewax.operators.X" title="Link to this definition">¶</a></dt>
<dd><p>Type of upstream items.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="bytewax.operators.Y">
<span class="sig-name descname"><span class="pre">Y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.12)"><span class="pre">TypeVar</span></a></em><a class="headerlink" href="#bytewax.operators.Y" title="Link to this definition">¶</a></dt>
<dd><p>Type of modified downstream items.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="bytewax.operators.V">
<span class="sig-name descname"><span class="pre">V</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.12)"><span class="pre">TypeVar</span></a></em><a class="headerlink" href="#bytewax.operators.V" title="Link to this definition">¶</a></dt>
<dd><p>Type of upstream values.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="bytewax.operators.W">
<span class="sig-name descname"><span class="pre">W</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.12)"><span class="pre">TypeVar</span></a></em><a class="headerlink" href="#bytewax.operators.W" title="Link to this definition">¶</a></dt>
<dd><p>Type of modified downstream values.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="bytewax.operators.S">
<span class="sig-name descname"><span class="pre">S</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.12)"><span class="pre">TypeVar</span></a></em><a class="headerlink" href="#bytewax.operators.S" title="Link to this definition">¶</a></dt>
<dd><p>Type of state snapshots.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="bytewax.operators.KeyedStream">
<span class="sig-name descname"><span class="pre">KeyedStream</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeAlias" title="(in Python v3.12)"><span class="pre">TypeAlias</span></a></em><a class="headerlink" href="#bytewax.operators.KeyedStream" title="Link to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream</span></code></a> of <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code> 2-tuples.</p>
</dd></dl>

</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="bytewax.operators.BranchOut">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BranchOut</span></span><a class="headerlink" href="#bytewax.operators.BranchOut" title="Link to this definition">¶</a></dt>
<dd><dl class="myst field-list simple">
<dt class="field-odd">Bases<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Generic</span></code></a><code class="docutils literal notranslate"><span class="pre">[</span></code><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> </code><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Y</span></code></a><code class="docutils literal notranslate"><span class="pre">]</span></code></p></li>
</ul>
</dd>
</dl>
<p>Streams returned from the <a class="reference internal" href="#bytewax.operators.branch" title="bytewax.operators.branch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">branch</span></code></a> operator.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bytewax.operators.BranchOut.trues">
<span class="sig-name descname"><span class="pre">trues</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#bytewax.operators.BranchOut.trues" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bytewax.operators.BranchOut.falses">
<span class="sig-name descname"><span class="pre">falses</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><span class="pre">Y</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#bytewax.operators.BranchOut.falses" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bytewax.operators.UnaryLogic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UnaryLogic</span></span><a class="headerlink" href="#bytewax.operators.UnaryLogic" title="Link to this definition">¶</a></dt>
<dd><dl class="myst field-list simple">
<dt class="field-odd">Bases<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ABC</span></code></a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generic" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Generic</span></code></a><code class="docutils literal notranslate"><span class="pre">[</span></code><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><code class="xref py py-obj docutils literal notranslate"><span class="pre">V</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> </code><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><code class="xref py py-obj docutils literal notranslate"><span class="pre">W</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> </code><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><code class="xref py py-obj docutils literal notranslate"><span class="pre">S</span></code></a><code class="docutils literal notranslate"><span class="pre">]</span></code></p></li>
</ul>
</dd>
</dl>
<p>Abstract class to define a <a class="reference internal" href="#bytewax.operators.unary" title="bytewax.operators.unary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unary</span></code></a> operator.</p>
<p>The operator will call these methods in order: <a class="reference internal" href="#bytewax.operators.UnaryLogic.on_item" title="bytewax.operators.UnaryLogic.on_item"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_item</span></code></a>
once for any items queued, then <a class="reference internal" href="#bytewax.operators.UnaryLogic.on_notify" title="bytewax.operators.UnaryLogic.on_notify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_notify</span></code></a> if the
notification time has passed, then <a class="reference internal" href="#bytewax.operators.UnaryLogic.on_eof" title="bytewax.operators.UnaryLogic.on_eof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_eof</span></code></a> if the
upstream is EOF and no new items will be received this execution.
If the logic is retained after all the above calls then
<a class="reference internal" href="#bytewax.operators.UnaryLogic.notify_at" title="bytewax.operators.UnaryLogic.notify_at"><code class="xref py py-obj docutils literal notranslate"><span class="pre">notify_at</span></code></a> will be called. <a class="reference internal" href="#bytewax.operators.UnaryLogic.snapshot" title="bytewax.operators.UnaryLogic.snapshot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">snapshot</span></code></a> is
periodically called.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bytewax.operators.UnaryLogic.RETAIN">
<span class="sig-name descname"><span class="pre">RETAIN</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bytewax.operators.UnaryLogic.RETAIN" title="Link to this definition">¶</a></dt>
<dd><p>This logic should be retained after this returns.</p>
<p>If you always return this, this state will never be deleted and if
your key-space grows without bound, your memory usage will also
grow without bound.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bytewax.operators.UnaryLogic.DISCARD">
<span class="sig-name descname"><span class="pre">DISCARD</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></em><a class="headerlink" href="#bytewax.operators.UnaryLogic.DISCARD" title="Link to this definition">¶</a></dt>
<dd><p>This logic should be discarded immediately after this returns.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bytewax.operators.UnaryLogic.on_item">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_item</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">now</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><span class="pre">datetime</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.UnaryLogic.on_item" title="Link to this definition">¶</a></dt>
<dd><p>Called on each new upstream item.</p>
<p>This will be called multiple times in a row if there are
multiple items from upstream.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>now</strong> – The current <code class="docutils literal notranslate"><span class="pre">datetime</span></code>.</p></li>
<li><p><strong>value</strong> – The value of the upstream <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2-tuple of: any values to emit downstream and
wheither to discard this logic. Values will be wrapped in
<code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code> automatically.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bytewax.operators.UnaryLogic.on_notify">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_notify</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">sched</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><span class="pre">datetime</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.UnaryLogic.on_notify" title="Link to this definition">¶</a></dt>
<dd><p>Called when the scheduled notification time has passed.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sched</strong> – The scheduled notification time.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2-tuple of: any values to emit downstream and
wheither to discard this logic. Values will be wrapped in
<code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code> automatically.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bytewax.operators.UnaryLogic.on_eof">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_eof</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.UnaryLogic.on_eof" title="Link to this definition">¶</a></dt>
<dd><p>The upstream has no more items on this execution.</p>
<p>This will only be called once per execution after
<a class="reference internal" href="#bytewax.operators.UnaryLogic.on_item" title="bytewax.operators.UnaryLogic.on_item"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_item</span></code></a> is done being called.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>2-tuple of: any values to emit downstream and
wheither to discard this logic. Values will be wrapped in
<code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">value)</span></code> automatically.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bytewax.operators.UnaryLogic.notify_at">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">notify_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><span class="pre">datetime</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.UnaryLogic.notify_at" title="Link to this definition">¶</a></dt>
<dd><p>Return the next notification time.</p>
<p>This will be called once right after the logic is built, and
if any of the <code class="docutils literal notranslate"><span class="pre">on_*</span></code> methods were called if the logic was
retained.</p>
<p>This must always return the next notification time. The
operator only stores a single next time, so if</p>
<dl class="myst field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scheduled time. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, no <a class="reference internal" href="#bytewax.operators.UnaryLogic.on_notify" title="bytewax.operators.UnaryLogic.on_notify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">on_notify</span></code></a>
callback will occur.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bytewax.operators.UnaryLogic.snapshot">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">snapshot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a></span></span><a class="headerlink" href="#bytewax.operators.UnaryLogic.snapshot" title="Link to this definition">¶</a></dt>
<dd><p>Return a immutable copy of the state for recovery.</p>
<p>This will be called periodically by the runtime.</p>
<p>The value returned here will be passed back to the <code class="docutils literal notranslate"><span class="pre">builder</span></code>
function of <a class="reference internal" href="#bytewax.operators.unary" title="bytewax.operators.unary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unary</span></code></a> when resuming.</p>
<p>The state must be <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pickle</span></code></a>-able.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p><strong>The state must be effectively immutable!</strong> If any of the
other functions in this class might be able to mutate the
state, you must <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy.deepcopy</span></code></a> or something
equivalent before returning it here.</p>
</div>
<dl class="myst field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The immutable state to be <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pickle</span></code></a>d.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.branch">
<span class="sig-name descname"><span class="pre">branch</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">predicate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.BranchOut" title="bytewax.operators.BranchOut"><span class="pre">BranchOut</span></a></span></span><a class="headerlink" href="#bytewax.operators.branch" title="Link to this definition">¶</a></dt>
<dd><p>Divide items into two streams with a predicate.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bytewax.operators</span> <span class="k">as</span> <span class="nn">op</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.testing</span> <span class="kn">import</span> <span class="n">run_main</span><span class="p">,</span> <span class="n">TestingSource</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">flow</span> <span class="o">=</span> <span class="n">Dataflow</span><span class="p">(</span><span class="s2">&quot;branch_eg&quot;</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">nums</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s2">&quot;nums&quot;</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">TestingSource</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">b_out</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">branch</span><span class="p">(</span><span class="s2">&quot;even_odd&quot;</span><span class="p">,</span> <span class="n">nums</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">evens</span> <span class="o">=</span> <span class="n">b_out</span><span class="o">.</span><span class="n">trues</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">odds</span> <span class="o">=</span> <span class="n">b_out</span><span class="o">.</span><span class="n">falses</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;evens&quot;</span><span class="p">,</span> <span class="n">evens</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;odds&quot;</span><span class="p">,</span> <span class="n">odds</span><span class="p">)</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>
<span class="linenos">11</span><span class="go">branch_eg.odds: 1</span>
<span class="linenos">12</span><span class="go">branch_eg.evens: 2</span>
<span class="linenos">13</span><span class="go">branch_eg.odds: 3</span>
<span class="linenos">14</span><span class="go">branch_eg.evens: 4</span>
<span class="linenos">15</span><span class="go">branch_eg.odds: 5</span>
</pre></div>
</div>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream to divide.</p></li>
<li><p><strong>predicate</strong> – <p>Function to call on each upstream item. Items for
which this returns <code class="docutils literal notranslate"><span class="pre">True</span></code> will be put into one branch stream;
<code class="docutils literal notranslate"><span class="pre">False</span></code> the other branch stream.</p>
<p>If this function is a <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeGuard" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">typing.TypeGuard</span></code></a>, the
downstreams will be properly typed.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of items for which the predicate returns
<code class="docutils literal notranslate"><span class="pre">True</span></code>, and a stream of items for which the predicate returns
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.flat_map_batch">
<span class="sig-name descname"><span class="pre">flat_map_batch</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><span class="pre">Y</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><span class="pre">Y</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.flat_map_batch" title="Link to this definition">¶</a></dt>
<dd><p>Transform an entire batch of items 1-to-many.</p>
<p>The batch size received here depends on the exact behavior of the
upstream input sources and operators. It should be used as a
performance optimization when processing multiple items at once
has much reduced overhead.</p>
<p>See also the <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> parameter on various input sources.</p>
<p>See also the <a class="reference internal" href="#bytewax.operators.collect" title="bytewax.operators.collect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect</span></code></a> operator, which collects multiple
items next to each other in a stream into a single list of them
flowing through the stream.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream.</p></li>
<li><p><strong>mapper</strong> – Called once with each batch of items the runtime
receives. Returns the items to emit downstream.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of each item returned by the mapper.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.input">
<span class="sig-name descname"><span class="pre">input</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">flow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Dataflow" title="bytewax.dataflow.Dataflow"><span class="pre">Dataflow</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.inputs.html#bytewax.inputs.Source" title="bytewax.inputs.Source"><span class="pre">Source</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.input" title="Link to this definition">¶</a></dt>
<dd><p>Introduce items into a dataflow.</p>
<p>See <a class="reference internal" href="bytewax.inputs.html#module-bytewax.inputs" title="bytewax.inputs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytewax.inputs</span></code></a> for more information on how input
works. See <a class="reference internal" href="bytewax.connectors.html#module-bytewax.connectors" title="bytewax.connectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytewax.connectors</span></code></a> for a buffet of our
built-in connector types.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>flow</strong> – The dataflow.</p></li>
<li><p><strong>source</strong> – To read items from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A stream of items from the source. See your specific
<a class="reference internal" href="bytewax.inputs.html#bytewax.inputs.Source" title="bytewax.inputs.Source"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Source</span></code></a> documentation for what kind
of item that is.</p>
<p>This stream might be keyed. See your specific
<a class="reference internal" href="bytewax.inputs.html#bytewax.inputs.Source" title="bytewax.inputs.Source"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Source</span></code></a>.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.inspect_debug">
<span class="sig-name descname"><span class="pre">inspect_debug</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">inspector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">_default_debug_inspector</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.inspect_debug" title="Link to this definition">¶</a></dt>
<dd><p>Observe items, their worker, and their epoch for debugging.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bytewax.operators</span> <span class="k">as</span> <span class="nn">op</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.testing</span> <span class="kn">import</span> <span class="n">TestingSource</span><span class="p">,</span> <span class="n">run_main</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.dataflow</span> <span class="kn">import</span> <span class="n">Dataflow</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">flow</span> <span class="o">=</span> <span class="n">Dataflow</span><span class="p">(</span><span class="s2">&quot;inspect_debug_eg&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s2">&quot;inp&quot;</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">TestingSource</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">inspect_debug</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="go">inspect_debug_eg.help W0 @1: 0</span>
<span class="linenos"> 9</span><span class="go">inspect_debug_eg.help W0 @1: 1</span>
<span class="linenos">10</span><span class="go">inspect_debug_eg.help W0 @1: 2</span>
</pre></div>
</div>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream.</p></li>
<li><p><strong>inspector</strong> – Called with the step ID, each item in the stream,
the epoch of that item, and the worker processing the item.
Defaults to printing out all the arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The upstream unmodified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">ups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.merge" title="Link to this definition">¶</a></dt>
<dd><p>Combine multiple streams together.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>*ups</strong> – Streams.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A single stream of the same type as all the upstreams
with items from all upstreams merged into it unmodified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.output">
<span class="sig-name descname"><span class="pre">output</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">sink</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.outputs.html#bytewax.outputs.Sink" title="bytewax.outputs.Sink"><span class="pre">Sink</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#bytewax.operators.output" title="Link to this definition">¶</a></dt>
<dd><p>Write items out of a dataflow.</p>
<p>See <a class="reference internal" href="bytewax.outputs.html#module-bytewax.outputs" title="bytewax.outputs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytewax.outputs</span></code></a> for more information on how output
works. See <a class="reference internal" href="bytewax.connectors.html#module-bytewax.connectors" title="bytewax.connectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytewax.connectors</span></code></a> for a buffet of our
built-in connector types.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream of items to write. See your specific
<a class="reference internal" href="bytewax.outputs.html#bytewax.outputs.Sink" title="bytewax.outputs.Sink"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sink</span></code></a> documentation for the required
type of those items.</p></li>
<li><p><strong>sink</strong> – Write items to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.redistribute">
<span class="sig-name descname"><span class="pre">redistribute</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.redistribute" title="Link to this definition">¶</a></dt>
<dd><p>Redistribute items randomly across all workers.</p>
<p>Bytewax’s execution model has workers executing all steps, but the
state in each step is partitioned across workers by some key.
Bytewax will only exchange an item between workers before stateful
steps in order to ensure correctness, that they interact with the
correct state for that key. Stateless operators (like
<a class="reference internal" href="#bytewax.operators.filter" title="bytewax.operators.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a>) are run on all workers and do not result in
exchanging items before or after they are run.</p>
<p>This can result in certain ordering of operators to result in poor
parallelization across an entire execution cluster. If the
previous step (like a
<a class="reference internal" href="bytewax.operators.window.html#bytewax.operators.window.reduce_window" title="bytewax.operators.window.reduce_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytewax.operators.window.reduce_window</span></code></a> or
<a class="reference internal" href="#bytewax.operators.input" title="bytewax.operators.input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input</span></code></a> with a
<a class="reference internal" href="bytewax.inputs.html#bytewax.inputs.FixedPartitionedSource" title="bytewax.inputs.FixedPartitionedSource"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedPartitionedSource</span></code></a>) concentrated
items on a subset of workers in the cluster, but the next step is
a CPU-intensive stateless step (like a <a class="reference internal" href="#bytewax.operators.map" title="bytewax.operators.map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map</span></code></a>), it’s
possible that not all workers will contribute to processing the
CPU-intesive step.</p>
<p>This operation has a overhead, since it will need to serialize,
send, and deserialize the items, so while it can significantly
speed up the execution in some cases, it can also make it slower.</p>
<p>A good use of this operator is to parallelize an IO bound step,
like a network request, or a heavy, single-cpu workload, on a
machine with multiple workers and multiple cpu cores that would
remain unused otherwise.</p>
<p>A bad use of this operator is if the operation you want to
parallelize is already really fast as it is, as the overhead can
overshadow the advantages of distributing the work. Another case
where you could see regressions in performance is if the heavy CPU
workload already spawns enough threads to use all the available
cores. In this case multiple processes trying to compete for the
cpu can end up being slower than doing the work serially. If the
workers run on different machines though, it might again be a
valuable use of the operator.</p>
<p>Use this operator with caution, and measure whether you get an
improvement out of it.</p>
<p>Once the work has been spread to another worker, it will stay on
those workers unless other operators explicitely move the item
again (usually on output).</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stream unmodified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.unary">
<span class="sig-name descname"><span class="pre">unary</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">builder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><span class="pre">datetime</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.UnaryLogic" title="bytewax.operators.UnaryLogic"><span class="pre">UnaryLogic</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.unary" title="Link to this definition">¶</a></dt>
<dd><p>Advanced generic stateful operator.</p>
<p>This is the lowest-level operator Bytewax provides and gives you
full control over all aspects of the operator processing and
lifecycle. Usualy you will want to use a higher-level operator
than this.</p>
<p>Subclass <a class="reference internal" href="#bytewax.operators.UnaryLogic" title="bytewax.operators.UnaryLogic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UnaryLogic</span></code></a> to define its behavior. See
documentation there.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Keyed stream.</p></li>
<li><p><strong>builder</strong> – Called whenver a new key is encountered with the
current <a class="reference external" href="https://docs.python.org/3/library/datetime.html#module-datetime" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime</span></code></a> and the resume state returned from
<a class="reference internal" href="#bytewax.operators.UnaryLogic.snapshot" title="bytewax.operators.UnaryLogic.snapshot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UnaryLogic.snapshot</span></code></a> for this key, if any. This
should close over any non-state configuration and combine it
with the resume state to return the prepared
<a class="reference internal" href="#bytewax.operators.UnaryLogic" title="bytewax.operators.UnaryLogic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UnaryLogic</span></code></a> for the new key.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Keyed stream of all items returned from
<a class="reference internal" href="#bytewax.operators.UnaryLogic.on_item" title="bytewax.operators.UnaryLogic.on_item"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UnaryLogic.on_item</span></code></a>, <a class="reference internal" href="#bytewax.operators.UnaryLogic.on_notify" title="bytewax.operators.UnaryLogic.on_notify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UnaryLogic.on_notify</span></code></a>,
and <a class="reference internal" href="#bytewax.operators.UnaryLogic.on_eof" title="bytewax.operators.UnaryLogic.on_eof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UnaryLogic.on_eof</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.12)"><span class="pre">timedelta</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">max_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.collect" title="Link to this definition">¶</a></dt>
<dd><p>Collect items into a list up to a size or a timeout.</p>
<p>See <a class="reference internal" href="bytewax.operators.window.html#bytewax.operators.window.collect_window" title="bytewax.operators.window.collect_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytewax.operators.window.collect_window</span></code></a> for more
control over time.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream of individual items.</p></li>
<li><p><strong>timeout</strong> – Timeout before emitting the list, even if <code class="docutils literal notranslate"><span class="pre">max_size</span></code>
was not reached.</p></li>
<li><p><strong>max_size</strong> – Emit the list once it reaches this size, even if
<code class="docutils literal notranslate"><span class="pre">timeout</span></code> was not reached.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of upstream items gathered into lists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.count_final">
<span class="sig-name descname"><span class="pre">count_final</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.count_final" title="Link to this definition">¶</a></dt>
<dd><p>Count the number of occurrences of items in the entire stream.</p>
<p>This will only return counts once the upstream is EOF. You’ll need
to use <a class="reference internal" href="bytewax.operators.window.html#bytewax.operators.window.count_window" title="bytewax.operators.window.count_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytewax.operators.window.count_window</span></code></a> on infinite
data.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream of items to count.</p></li>
<li><p><strong>key</strong> – Function to convert each item into a string key. The
counting machinery does not compare the items directly,
instead it groups by this string key.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">count)</span></code> once the upstream is EOF.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.flat_map">
<span class="sig-name descname"><span class="pre">flat_map</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><span class="pre">Y</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><span class="pre">Y</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.flat_map" title="Link to this definition">¶</a></dt>
<dd><p>Transform items one-to-many.</p>
<p>This is like a combination of <a class="reference internal" href="#bytewax.operators.map" title="bytewax.operators.map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map</span></code></a> and <a class="reference internal" href="#bytewax.operators.flatten" title="bytewax.operators.flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flatten</span></code></a>.</p>
<p>It is commonly used for:</p>
<ul class="simple">
<li><p>Tokenizing</p></li>
<li><p>Flattening hierarchical objects</p></li>
<li><p>Breaking up aggregations for further processing</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bytewax.operators</span> <span class="k">as</span> <span class="nn">op</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.testing</span> <span class="kn">import</span> <span class="n">TestingSource</span><span class="p">,</span> <span class="n">run_main</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.dataflow</span> <span class="kn">import</span> <span class="n">Dataflow</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">flow</span> <span class="o">=</span> <span class="n">Dataflow</span><span class="p">(</span><span class="s2">&quot;flat_map_eg&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">inp</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hello world&quot;</span><span class="p">]</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s2">&quot;inp&quot;</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">TestingSource</span><span class="p">(</span><span class="n">inp</span><span class="p">))</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">split_into_words</span><span class="p">(</span><span class="n">sentence</span><span class="p">):</span>
<span class="linenos"> 8</span><span class="gp">... </span>    <span class="k">return</span> <span class="n">sentence</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">flat_map</span><span class="p">(</span><span class="s2">&quot;split_words&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">split_into_words</span><span class="p">)</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="linenos">11</span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>
<span class="linenos">12</span><span class="go">flat_map_eg.out: &#39;hello&#39;</span>
<span class="linenos">13</span><span class="go">flat_map_eg.out: &#39;world&#39;</span>
</pre></div>
</div>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream.</p></li>
<li><p><strong>mapper</strong> – Called once on each upstream item. Returns the items
to emit downstream.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of each item returned by the mapper.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.flat_map_value">
<span class="sig-name descname"><span class="pre">flat_map_value</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.flat_map_value" title="Link to this definition">¶</a></dt>
<dd><p>Transform values one-to-many.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Keyed stream.</p></li>
<li><p><strong>mapper</strong> – Called once on each upstream value. Returns the
values to emit downstream.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A keyed stream of each value returned by the mapper.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.flatten">
<span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.flatten" title="Link to this definition">¶</a></dt>
<dd><p>Move all sub-items up a level.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream of iterables.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of the items within each iterable in the
upstream.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">predicate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.filter" title="Link to this definition">¶</a></dt>
<dd><p>Keep only some items.</p>
<p>It is commonly used for:</p>
<ul class="simple">
<li><p>Selecting relevant events</p></li>
<li><p>Removing empty events</p></li>
<li><p>Removing sentinels</p></li>
<li><p>Removing stop words</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bytewax.operators</span> <span class="k">as</span> <span class="nn">op</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.testing</span> <span class="kn">import</span> <span class="n">TestingSource</span><span class="p">,</span> <span class="n">run_main</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.dataflow</span> <span class="kn">import</span> <span class="n">Dataflow</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">flow</span> <span class="o">=</span> <span class="n">Dataflow</span><span class="p">(</span><span class="s2">&quot;filter_eg&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s2">&quot;inp&quot;</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">TestingSource</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">is_odd</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<span class="linenos"> 7</span><span class="gp">... </span>    <span class="k">return</span> <span class="n">item</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;filter_odd&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">is_odd</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>
<span class="linenos">11</span><span class="go">filter_eg.out: 1</span>
<span class="linenos">12</span><span class="go">filter_eg.out: 3</span>
</pre></div>
</div>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream.</p></li>
<li><p><strong>predicate</strong> – Called with each upstream item. Only items for
which this returns true <code class="docutils literal notranslate"><span class="pre">True</span></code> will be emitted downstream.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream with only the upstream items for which the
predicate returns <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.filter_value">
<span class="sig-name descname"><span class="pre">filter_value</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">predicate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.filter_value" title="Link to this definition">¶</a></dt>
<dd><p>Selectively keep only some items from a keyed stream.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Keyed stream.</p></li>
<li><p><strong>predicate</strong> – Will be called with each upstream value. Only
values for which this returns <code class="docutils literal notranslate"><span class="pre">True</span></code> will be emitted
downstream.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A keyed stream with only the upstream pairs for which
the predicate returns <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.filter_map">
<span class="sig-name descname"><span class="pre">filter_map</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><span class="pre">Y</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><span class="pre">Y</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.filter_map" title="Link to this definition">¶</a></dt>
<dd><p>A one-to-maybe-one transformation of items.</p>
<p>This is like a combination of <code class="docutils literal notranslate"><span class="pre">map</span></code> and then <code class="docutils literal notranslate"><span class="pre">filter</span></code> with a
predicate removing <code class="docutils literal notranslate"><span class="pre">None</span></code> values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bytewax.operators</span> <span class="k">as</span> <span class="nn">op</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.testing</span> <span class="kn">import</span> <span class="n">TestingSource</span><span class="p">,</span> <span class="n">run_main</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.dataflow</span> <span class="kn">import</span> <span class="n">Dataflow</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">flow</span> <span class="o">=</span> <span class="n">Dataflow</span><span class="p">(</span><span class="s2">&quot;filter_map_eg&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">input</span><span class="p">(</span>
<span class="linenos"> 6</span><span class="gp">... </span>    <span class="s2">&quot;inp&quot;</span><span class="p">,</span>
<span class="linenos"> 7</span><span class="gp">... </span>    <span class="n">flow</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="gp">... </span>    <span class="n">TestingSource</span><span class="p">(</span>
<span class="linenos"> 9</span><span class="gp">... </span>        <span class="p">[</span>
<span class="linenos">10</span><span class="gp">... </span>            <span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="linenos">11</span><span class="gp">... </span>            <span class="p">{</span><span class="s2">&quot;bad&quot;</span><span class="p">:</span> <span class="s2">&quot;obj&quot;</span><span class="p">},</span>
<span class="linenos">12</span><span class="gp">... </span>        <span class="p">]</span>
<span class="linenos">13</span><span class="gp">... </span>    <span class="p">),</span>
<span class="linenos">14</span><span class="gp">... </span><span class="p">)</span>
<span class="linenos">15</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="linenos">16</span><span class="gp">... </span>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">dict</span> <span class="ow">or</span> <span class="s2">&quot;key&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<span class="linenos">17</span><span class="gp">... </span>        <span class="k">return</span> <span class="kc">None</span>
<span class="linenos">18</span><span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">19</span><span class="gp">... </span>        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">data</span>
<span class="linenos">20</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">filter_map</span><span class="p">(</span><span class="s2">&quot;validate&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">validate</span><span class="p">)</span>
<span class="linenos">21</span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="linenos">22</span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>
<span class="linenos">23</span><span class="go">filter_map_eg.out: (&#39;a&#39;, {&#39;key&#39;: &#39;a&#39;, &#39;val&#39;: 1})</span>
</pre></div>
</div>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream.</p></li>
<li><p><strong>mapper</strong> – Called on each item. Each return value is emitted
downstream, unless it is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of items returned from <code class="docutils literal notranslate"><span class="pre">mapper</span></code>, unless it is
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.fold_final">
<span class="sig-name descname"><span class="pre">fold_final</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">builder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.fold_final" title="Link to this definition">¶</a></dt>
<dd><p>Build an empty accumulator, then combine values into it.</p>
<p>It is like <a class="reference internal" href="#bytewax.operators.reduce_final" title="bytewax.operators.reduce_final"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reduce_final</span></code></a> but uses a function to build the
initial value.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Keyed stream.</p></li>
<li><p><strong>builder</strong> – Called the first time a key appears and is expected
to return the empty accumulator for that key.</p></li>
<li><p><strong>folder</strong> – Combines a new value into an existing accumulator and
returns the updated accumulator. The accumulator is initially
the empty accumulator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A keyed stream of the accumulators. <em>Only once the
upstream is EOF.</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.inspect">
<span class="sig-name descname"><span class="pre">inspect</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">inspector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">_default_inspector</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.inspect" title="Link to this definition">¶</a></dt>
<dd><p>Observe items for debugging.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bytewax.operators</span> <span class="k">as</span> <span class="nn">op</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.testing</span> <span class="kn">import</span> <span class="n">run_main</span><span class="p">,</span> <span class="n">TestingSource</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.dataflow</span> <span class="kn">import</span> <span class="n">Dataflow</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">flow</span> <span class="o">=</span> <span class="n">Dataflow</span><span class="p">(</span><span class="s2">&quot;my_flow&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s2">&quot;inp&quot;</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">TestingSource</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="go">my_flow.help: 0</span>
<span class="linenos"> 9</span><span class="go">my_flow.help: 1</span>
<span class="linenos">10</span><span class="go">my_flow.help: 2</span>
</pre></div>
</div>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream.</p></li>
<li><p><strong>inspector</strong> – Called with the step ID and each item in the
stream. Defaults to printing the step ID and each item.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The upstream unmodified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">running</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.join" title="Link to this definition">¶</a></dt>
<dd><p>Gather together the value for a key on multiple streams.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>*sides</strong> – Keyed streams.</p></li>
<li><p><strong>running</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, perform a “running join” and, emit the
current set of values (if any) each time a new value arrives.
The set of values will <em>never be discarded</em> so might result in
unbounded memory use. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, perform a “complete join”
and, only emit once there is a value on each stream, then
discard the set. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Emits a tuple with the value from each stream in the
order of the argument list. If <code class="docutils literal notranslate"><span class="pre">running</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, some
values might be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.join_named">
<span class="sig-name descname"><span class="pre">join_named</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">running</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.join_named" title="Link to this definition">¶</a></dt>
<dd><p>Gather together the value for a key on multiple named streams.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>**sides</strong> – Named keyed streams. The name of each stream will be
keys in the emitted <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>.</p></li>
<li><p><strong>running</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, perform a “running join” and, emit the
current set of values (if any) each time a new value arrives.
The set of values will <em>never be discarded</em> so might result in
unbounded memory use. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, perform a “complete join”
and, only emit once there is a value on each stream, then
discard the set. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Emits a mapping the name to the value from each stream.
If <code class="docutils literal notranslate"><span class="pre">running</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, some names might be missing from the
mapping.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.key_on">
<span class="sig-name descname"><span class="pre">key_on</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.key_on" title="Link to this definition">¶</a></dt>
<dd><p>Add a key for each item.</p>
<p>This allows you to use all the keyed operators that require the
upstream to be a <a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KeyedStream</span></code></a>.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream.</p></li>
<li><p><strong>key</strong> – Called on each item and should return the key for that
item.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of 2-tuples of <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">item)</span></code> AKA a keyed
stream. The keys come from the return value of the <code class="docutils literal notranslate"><span class="pre">key</span></code>
function; upstream items will automatically be attached as
values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.map">
<span class="sig-name descname"><span class="pre">map</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.X" title="bytewax.operators.X"><span class="pre">X</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><span class="pre">Y</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.Y" title="bytewax.operators.Y"><span class="pre">Y</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.map" title="Link to this definition">¶</a></dt>
<dd><p>Transform items one-by-one.</p>
<p>It is commonly used for:</p>
<ul class="simple">
<li><p>Serialization and deserialization.</p></li>
<li><p>Selection of fields.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bytewax.operators</span> <span class="k">as</span> <span class="nn">op</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.testing</span> <span class="kn">import</span> <span class="n">run_main</span><span class="p">,</span> <span class="n">TestingSource</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.dataflow</span> <span class="kn">import</span> <span class="n">Dataflow</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">flow</span> <span class="o">=</span> <span class="n">Dataflow</span><span class="p">(</span><span class="s2">&quot;map_eg&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s2">&quot;inp&quot;</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">TestingSource</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">add_one</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<span class="linenos"> 7</span><span class="gp">... </span>    <span class="k">return</span> <span class="n">item</span> <span class="o">+</span> <span class="mi">10</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;add_one&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">add_one</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>
<span class="linenos">11</span><span class="go">map_eg.out: 10</span>
<span class="linenos">12</span><span class="go">map_eg.out: 11</span>
<span class="linenos">13</span><span class="go">map_eg.out: 12</span>
</pre></div>
</div>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Stream.</p></li>
<li><p><strong>mapper</strong> – Called on each item. Each return value is emitted
downstream.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A stream of items returned from the mapper.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.map_value">
<span class="sig-name descname"><span class="pre">map_value</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.map_value" title="Link to this definition">¶</a></dt>
<dd><p>Transform values one-by-one.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Keyed stream.</p></li>
<li><p><strong>mapper</strong> – Called on each value. Each return value is emitted
downstream.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A keyed stream of values returned from the mapper. The
key is unchanged.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.max_final">
<span class="sig-name descname"><span class="pre">max_final</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">_identity</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a></span></span><a class="headerlink" href="#bytewax.operators.max_final" title="Link to this definition">¶</a></dt>
<dd><p>Find the maximum value for each key.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Keyed stream.</p></li>
<li><p><strong>by</strong> – A function called on each value that is used to extract
what to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A keyed stream of the max values. <em>Only once the
upstream is EOF.</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.min_final">
<span class="sig-name descname"><span class="pre">min_final</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">_identity</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a></span></span><a class="headerlink" href="#bytewax.operators.min_final" title="Link to this definition">¶</a></dt>
<dd><p>Find the minumum value for each key.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Keyed stream.</p></li>
<li><p><strong>by</strong> – A function called on each value that is used to extract
what to compare.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A keyed stream of the min values. <em>Only once the
upstream is EOF.</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.raises">
<span class="sig-name descname"><span class="pre">raises</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="bytewax.dataflow.html#bytewax.dataflow.Stream" title="bytewax.dataflow.Stream"><span class="pre">Stream</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#bytewax.operators.raises" title="Link to this definition">¶</a></dt>
<dd><p>Raise an exception and crash the dataflow on any item.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Any item on this stream will throw a
<a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.reduce_final">
<span class="sig-name descname"><span class="pre">reduce_final</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">reducer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.reduce_final" title="Link to this definition">¶</a></dt>
<dd><p>Distill all values for a key down into a single value.</p>
<p>It is like <a class="reference internal" href="#bytewax.operators.fold_final" title="bytewax.operators.fold_final"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fold_final</span></code></a> but the first value is the initial
accumulator.</p>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Keyed stream.</p></li>
<li><p><strong>reducer</strong> – Combines a new value into an old value and returns
the combined value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A keyed stream of the accumulators. <em>Only once the
upstream is EOF.</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bytewax.operators.stateful_map">
<span class="sig-name descname"><span class="pre">stateful_map</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">step_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">builder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">mapper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.V" title="bytewax.operators.V"><span class="pre">V</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.S" title="bytewax.operators.S"><span class="pre">S</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bytewax.operators.KeyedStream" title="bytewax.operators.KeyedStream"><span class="pre">KeyedStream</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bytewax.operators.W" title="bytewax.operators.W"><span class="pre">W</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#bytewax.operators.stateful_map" title="Link to this definition">¶</a></dt>
<dd><p>Transform values one-to-one, referencing a persistent state.</p>
<p>It is commonly used for:</p>
<ul class="simple">
<li><p>Anomaly detection</p></li>
<li><p>State machines</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bytewax.operators</span> <span class="k">as</span> <span class="nn">op</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.testing</span> <span class="kn">import</span> <span class="n">TestingSource</span><span class="p">,</span> <span class="n">run_main</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">bytewax.dataflow</span> <span class="kn">import</span> <span class="n">Dataflow</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">flow</span> <span class="o">=</span> <span class="n">Dataflow</span><span class="p">(</span><span class="s2">&quot;stateful_map_eg&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">inp</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos"> 6</span><span class="gp">... </span>    <span class="s2">&quot;a&quot;</span><span class="p">,</span>
<span class="linenos"> 7</span><span class="gp">... </span>    <span class="s2">&quot;a&quot;</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="gp">... </span>    <span class="s2">&quot;a&quot;</span><span class="p">,</span>
<span class="linenos"> 9</span><span class="gp">... </span>    <span class="s2">&quot;b&quot;</span><span class="p">,</span>
<span class="linenos">10</span><span class="gp">... </span>    <span class="s2">&quot;a&quot;</span><span class="p">,</span>
<span class="linenos">11</span><span class="gp">... </span><span class="p">]</span>
<span class="linenos">12</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s2">&quot;inp&quot;</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">TestingSource</span><span class="p">(</span><span class="n">inp</span><span class="p">))</span>
<span class="linenos">13</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">key_on</span><span class="p">(</span><span class="s2">&quot;self_as_key&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="linenos">14</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">build_count</span><span class="p">():</span>
<span class="linenos">15</span><span class="gp">... </span>    <span class="k">return</span> <span class="mi">0</span>
<span class="linenos">16</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">running_count</span><span class="p">,</span> <span class="n">_item</span><span class="p">):</span>
<span class="linenos">17</span><span class="gp">... </span>    <span class="n">running_count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">18</span><span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">running_count</span><span class="p">,</span> <span class="n">running_count</span><span class="p">)</span>
<span class="linenos">19</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">stateful_map</span><span class="p">(</span><span class="s2">&quot;running_count&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">build_count</span><span class="p">,</span> <span class="n">check</span><span class="p">)</span>
<span class="linenos">20</span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="linenos">21</span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>
<span class="linenos">22</span><span class="go">stateful_map_eg.out: (&#39;a&#39;, 1)</span>
<span class="linenos">23</span><span class="go">stateful_map_eg.out: (&#39;a&#39;, 2)</span>
<span class="linenos">24</span><span class="go">stateful_map_eg.out: (&#39;a&#39;, 3)</span>
<span class="linenos">25</span><span class="go">stateful_map_eg.out: (&#39;b&#39;, 1)</span>
<span class="linenos">26</span><span class="go">stateful_map_eg.out: (&#39;a&#39;, 4)</span>
</pre></div>
</div>
<dl class="myst field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_id</strong> – Unique ID.</p></li>
<li><p><strong>up</strong> – Keyed stream.</p></li>
<li><p><strong>builder</strong> – Called whenever a new key is encountered and should
return the “empty state” for this key.</p></li>
<li><p><strong>mapper</strong> – Called whenever a value is encountered from upstream
with the last state, and then the upstream value. Should
return a 2-tuple of <code class="docutils literal notranslate"><span class="pre">(updated_state,</span> <span class="pre">emit_value)</span></code>. If the
updated state is <code class="docutils literal notranslate"><span class="pre">None</span></code>, discard it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A keyed stream.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>

        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="bytewax.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax</span></code></a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="bytewax.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="bytewax.connectors.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.connectors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bytewax.dataflow.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.dataflow</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bytewax.inputs.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.inputs</span></code></a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.operators</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="bytewax.operators.helpers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.operators.helpers</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="bytewax.operators.window.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.operators.window</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#data">Data</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.X"><code class="docutils literal notranslate"><span class="pre">X</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.Y"><code class="docutils literal notranslate"><span class="pre">Y</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.V"><code class="docutils literal notranslate"><span class="pre">V</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.W"><code class="docutils literal notranslate"><span class="pre">W</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.S"><code class="docutils literal notranslate"><span class="pre">S</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.KeyedStream"><code class="docutils literal notranslate"><span class="pre">KeyedStream</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.BranchOut"><code class="docutils literal notranslate"><span class="pre">BranchOut</span></code></a><ul>
<li class="toctree-l7"><a class="reference internal" href="#bytewax.operators.BranchOut.trues"><code class="docutils literal notranslate"><span class="pre">trues</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#bytewax.operators.BranchOut.falses"><code class="docutils literal notranslate"><span class="pre">falses</span></code></a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.UnaryLogic"><code class="docutils literal notranslate"><span class="pre">UnaryLogic</span></code></a><ul>
<li class="toctree-l7"><a class="reference internal" href="#bytewax.operators.UnaryLogic.RETAIN"><code class="docutils literal notranslate"><span class="pre">RETAIN</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#bytewax.operators.UnaryLogic.DISCARD"><code class="docutils literal notranslate"><span class="pre">DISCARD</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#bytewax.operators.UnaryLogic.on_item"><code class="docutils literal notranslate"><span class="pre">on_item()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#bytewax.operators.UnaryLogic.on_notify"><code class="docutils literal notranslate"><span class="pre">on_notify()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#bytewax.operators.UnaryLogic.on_eof"><code class="docutils literal notranslate"><span class="pre">on_eof()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#bytewax.operators.UnaryLogic.notify_at"><code class="docutils literal notranslate"><span class="pre">notify_at()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#bytewax.operators.UnaryLogic.snapshot"><code class="docutils literal notranslate"><span class="pre">snapshot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#functions">Functions</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.branch"><code class="docutils literal notranslate"><span class="pre">branch()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.flat_map_batch"><code class="docutils literal notranslate"><span class="pre">flat_map_batch()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.input"><code class="docutils literal notranslate"><span class="pre">input()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.inspect_debug"><code class="docutils literal notranslate"><span class="pre">inspect_debug()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.merge"><code class="docutils literal notranslate"><span class="pre">merge()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.output"><code class="docutils literal notranslate"><span class="pre">output()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.redistribute"><code class="docutils literal notranslate"><span class="pre">redistribute()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.unary"><code class="docutils literal notranslate"><span class="pre">unary()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.collect"><code class="docutils literal notranslate"><span class="pre">collect()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.count_final"><code class="docutils literal notranslate"><span class="pre">count_final()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.flat_map"><code class="docutils literal notranslate"><span class="pre">flat_map()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.flat_map_value"><code class="docutils literal notranslate"><span class="pre">flat_map_value()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.flatten"><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.filter"><code class="docutils literal notranslate"><span class="pre">filter()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.filter_value"><code class="docutils literal notranslate"><span class="pre">filter_value()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.filter_map"><code class="docutils literal notranslate"><span class="pre">filter_map()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.fold_final"><code class="docutils literal notranslate"><span class="pre">fold_final()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.inspect"><code class="docutils literal notranslate"><span class="pre">inspect()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.join"><code class="docutils literal notranslate"><span class="pre">join()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.join_named"><code class="docutils literal notranslate"><span class="pre">join_named()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.key_on"><code class="docutils literal notranslate"><span class="pre">key_on()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.map"><code class="docutils literal notranslate"><span class="pre">map()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.map_value"><code class="docutils literal notranslate"><span class="pre">map_value()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.max_final"><code class="docutils literal notranslate"><span class="pre">max_final()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.min_final"><code class="docutils literal notranslate"><span class="pre">min_final()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.raises"><code class="docutils literal notranslate"><span class="pre">raises()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.reduce_final"><code class="docutils literal notranslate"><span class="pre">reduce_final()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#bytewax.operators.stateful_map"><code class="docutils literal notranslate"><span class="pre">stateful_map()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="bytewax.outputs.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.outputs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bytewax.recovery.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.recovery</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bytewax.run.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bytewax.serde.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.serde</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bytewax.testing.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.testing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bytewax.tracing.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bytewax.tracing</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">


    </div>




  </body>
</html>
